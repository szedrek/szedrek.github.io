<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Family Journey 2023</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=geometry"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #startButton {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #startButton:hover {
            background-color: #45a049;
        }
        #globalMap {
            width: 100%;
            height: 400px;
            margin-bottom: 20px;
        }
        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #333;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
            opacity: 0;
            transition: opacity 1s, transform 1s;
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: white;
            border: 4px solid #FF9F55;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            right: 30px;
            border: medium solid white;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent white;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            left: 30px;
            border: medium solid white;
            border-width: 10px 10px 10px 0;
            border-color: transparent white transparent transparent;
        }
        .right::after {
            left: -16px;
        }
        .content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 6px;
        }
        .map {
            height: 200px;
            margin-top: 10px;
        }
        .photo {
            max-width: 100%;
            height: auto;
            cursor: pointer;
            transition: transform 0.3s ease-in-out;
        }
        .photo:hover {
            transform: scale(1.05);
        }
        #lightbox {
            display: none;
            position: fixed;
            z-index: 999;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }
        #lightbox-img {
            display: block;
            max-width: 90%;
            max-height: 90%;
            margin: auto;
            margin-top: 2%;
        }
        .summary {
            background-color: white;
            padding: 20px;
            border-radius: 6px;
            margin-top: 40px;
            opacity: 0;
            transition: opacity 1s;
        }
        .stat {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        #travelChart {
            max-width: 400px;
            margin: 20px auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Our Family Journey 2023</h1>
        <button id="startButton">Begin Journey</button>
        <div id="globalMap"></div>
        <div class="timeline" id="timeline">
            <!-- Timeline items will be dynamically added here -->
        </div>
        <div class="summary" id="summary">
            <h2>Year in Review</h2>
            <div class="stat">Total Days Abroad: <span id="daysAbroad">0</span></div>
            <div class="stat">Total Distance Traveled: <span id="distanceTraveled">0</span> km</div>
            <div class="stat">Countries Visited: <span id="countriesVisited">0</span></div>
            <canvas id="travelChart"></canvas>
        </div>
    </div>
    <div id="lightbox">
        <img id="lightbox-img" src="" alt="Lightbox Image">
    </div>

    <script>
        const journeyData = [
            {
                date: "January 15, 2023",
                location: "Paris, France",
                description: "Started our journey in the City of Light!",
                coordinates: {lat: 48.8566, lng: 2.3522},
                photo: "https://example.com/paris.jpg"
            },
            {
                date: "March 22, 2023",
                location: "Rome, Italy",
                description: "Explored ancient ruins and enjoyed delicious pasta.",
                coordinates: {lat: 41.9028, lng: 12.4964},
                photo: "https://example.com/rome.jpg"
            },
            {
                date: "June 10, 2023",
                location: "Tokyo, Japan",
                description: "Immersed ourselves in the unique blend of tradition and technology.",
                coordinates: {lat: 35.6762, lng: 139.6503},
                photo: "https://example.com/tokyo.jpg"
            },
            {
                date: "September 5, 2023",
                location: "New York City, USA",
                description: "Experienced the energy of the Big Apple.",
                coordinates: {lat: 40.7128, lng: -74.0060},
                photo: "https://example.com/nyc.jpg"
            },
            {
                date: "December 20, 2023",
                location: "Sydney, Australia",
                description: "Ended our year-long journey with a sunny Christmas!",
                coordinates: {lat: -33.8688, lng: 151.2093},
                photo: "https://example.com/sydney.jpg"
            }
        ];

        let globalMap, globalMapMarkers = [], animationPath;
        let currentEventIndex = -1;

        function createTimelineItem(journey, index) {
            const item = document.createElement('div');
            item.className = `timeline-item ${index % 2 === 0 ? 'left' : 'right'}`;
            item.id = `event-${index}`;
    
            const content = document.createElement('div');
            content.className = 'content';
    
            content.innerHTML = `
                <h2></h2>
                <h3></h3>
                <p></p>
                <div id="map-${index}" class="map"></div>
                <img src="${journey.photo}" alt="${journey.location}" class="photo">
            `;
    
            item.appendChild(content);
            return item;
        }

        function initMap(mapId, coordinates) {
            const map = new google.maps.Map(document.getElementById(mapId), {
                zoom: 10,
                center: coordinates
            });
            new google.maps.Marker({
                position: coordinates,
                map: map
            });
        }

        function initGlobalMap() {
            globalMap = new google.maps.Map(document.getElementById('globalMap'), {
                zoom: 2,
                center: {lat: 20, lng: 0}
            });

            const bounds = new google.maps.LatLngBounds();
            journeyData.forEach((journey, index) => {
                const marker = new google.maps.Marker({
                    position: journey.coordinates,
                    map: globalMap,
                    title: journey.location,
                    label: (index + 1).toString()
                });
                globalMapMarkers.push(marker);
                bounds.extend(marker.getPosition());
            });

            globalMap.fitBounds(bounds);

            const pathCoordinates = journeyData.map(journey => journey.coordinates);
            animationPath = new google.maps.Polyline({
                path: pathCoordinates,
                geodesic: true,
                strokeColor: '#FF0000',
                strokeOpacity: 1.0,
                strokeWeight: 2
            });
        }

        function animateRoute() {
            animationPath.setMap(globalMap);
            let step = 0;
            const numSteps = 100;
            const animationInterval = setInterval(() => {
                step++;
                if (step > numSteps) {
                    clearInterval(animationInterval);
                    return;
                }
                const are = [
                    new google.maps.LatLng(
                        journeyData[0].coordinates.lat,
                        journeyData[0].coordinates.lng
                    )
                ];
                for (let i = 0; i < journeyData.length - 1; i++) {
                    const path = google.maps.geometry.spherical.interpolate(
                        new google.maps.LatLng(journeyData[i].coordinates.lat, journeyData[i].coordinates.lng),
                        new google.maps.LatLng(journeyData[i+1].coordinates.lat, journeyData[i+1].coordinates.lng),
                        step / numSteps
                    );
                    are.push(path);
                }
                animationPath.setPath(are);
            }, 50);
        }

        function animateNextEvent() {
            currentEventIndex++;
            if (currentEventIndex < journeyData.length) {
                const item = document.getElementById(`event-${currentEventIndex}`);
                item.style.opacity = '1';
                item.style.transform = 'translateY(0)';
        
                // Animate text content
                const dateElement = item.querySelector('h2');
                const locationElement = item.querySelector('h3');
                const descriptionElement = item.querySelector('p');
        
                animateText(dateElement, journeyData[currentEventIndex].date, 1000);
                setTimeout(() => animateText(locationElement, journeyData[currentEventIndex].location, 1000), 1000);
                setTimeout(() => animateText(descriptionElement, journeyData[currentEventIndex].description, 2000), 2000);
        
                initMap(`map-${currentEventIndex}`, journeyData[currentEventIndex].coordinates);
                globalMapMarkers[currentEventIndex].setAnimation(google.maps.Animation.BOUNCE);
                setTimeout(() => {
                    globalMapMarkers[currentEventIndex].setAnimation(null);
                }, 2000);
                smoothScrollTo(item);
                setTimeout(animateNextEvent, 7000); // Increased wait time to allow for text animations
            } else {
                document.getElementById('summary').style.opacity = '1';
                initSummary();
                smoothScrollTo(document.getElementById('summary'));
            }
        }

        function smoothScrollTo(element) {
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function initTimeline() {
            const timeline = document.getElementById('timeline');
            journeyData.forEach((journey, index) => {
                const item = createTimelineItem(journey, index);
                timeline.appendChild(item);
            });
        }

        function initLightbox() {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            
            document.querySelectorAll('.photo').forEach(img => {
                img.addEventListener('click', function() {
                    lightboxImg.src = this.src;
                    lightbox.style.display = 'block';
                });
            });
            
            lightbox.addEventListener('click', function() {
                this.style.display = 'none';
            });
        }

        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function initSummary() {
            const daysAbroad = 150;
            const distanceTraveled = 25000;
            const countriesVisited = 5;

            animateValue(document.getElementById("daysAbroad"), 0, daysAbroad, 2000);
            animateValue(document.getElementById("distanceTraveled"), 0, distanceTraveled, 2000);
            animateValue(document.getElementById("countriesVisited"), 0, countriesVisited, 2000);

            const ctx = document.getElementById('travelChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Days Abroad', 'Days at Home'],
                    datasets: [{
                        data: [daysAbroad, 365 - daysAbroad],
                        backgroundColor: ['#FF6384', '#36A2EB']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'Time Spent Abroad vs Home'
                        }
                    }
                }
            });
        }

        function startJourney() {
            document.getElementById('startButton').style.display = 'none';
            animateRoute();
            animateNextEvent();
        }

        function animateText(element, text, duration) {
            let index = 0;
            let interval = setInterval(() => {
                element.textContent = text.slice(0, index);
                if (index >= text.length) {
                    clearInterval(interval);
                }
                index++;
            }, duration / text.length);
        }

        window.addEventListener('load', () => {
            initTimeline();
            initLightbox();
            initGlobalMap();
            document.getElementById('startButton').addEventListener('click', startJourney);
        });
    </script>
</body>
</html>

